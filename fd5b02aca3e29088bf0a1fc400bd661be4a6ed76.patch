From fd5b02aca3e29088bf0a1fc400bd661be4a6ed76 Mon Sep 17 00:00:00 2001
From: zhailiangliang <zhailiangliang@loongson.cn>
Date: Thu, 14 Dec 2023 16:42:14 +0800
Subject: [PATCH] fix null pointer dereference in
 libheif/uncompressed_image.cc:758

---
 libheif/uncompressed_image.cc | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/libheif/uncompressed_image.cc b/libheif/uncompressed_image.cc
index c91e5dba4f..487d4cedbe 100644
--- a/libheif/uncompressed_image.cc
+++ b/libheif/uncompressed_image.cc
@@ -616,6 +616,13 @@ Error UncompressedImageCodec::decode_uncompressed_image(const std::shared_ptr<co
   if (error) {
     return error;
   }
+
+  if (!(uncompressed_data.data())) {
+    return Error(heif_error_Invalid_input,
+                 heif_suberror_Unspecified,
+                 "Invalid data: uncompressed_data.data() is null for uncompressed codec");
+  }
+
   uint32_t width = 0;
   uint32_t height = 0;
   bool found_ispe = false;
